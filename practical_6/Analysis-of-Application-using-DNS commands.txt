DNS Packet Analysis (Windows only)

Analysis of Application Layer Packets (DNS) using DNS commands & Wireshark in Windows

 Objective:
•	To understand the working of DNS as an application layer protocol.
•	To analyze DNS packets generated by DNS commands.
•	To capture and study DNS packets using Wireshark on Windows.

 Software/Tools Required:
•	Windows PC with Internet access
•	Command Prompt (cmd)
•	Wireshark (download from https://www.wireshark.org/)

 Step-by-step Procedure:

Part A: Using DNS Commands (nslookup)
Step 1: Open Command Prompt
•	Press Win + R, type cmd, and press Enter.
Step 2: Find IP address of a domain
nslookup www.example.com
•	Observe:
o	DNS server used (often your ISP’s DNS or local DNS server)
o	The resolved IP address
Step 3: Perform a reverse lookup (IP → domain)
nslookup 93.184.216.34
•	See the canonical domain name corresponding to the IP.
Step 4: Query different DNS record types (e.g., mail servers)
nslookup -query=MX example.com
•	Shows mail exchange servers for the domain.
Part B: DNS Packet Analysis with Wireshark
Step 1: Install and open Wireshark
•	Download and install Wireshark.
•	Open Wireshark as Administrator.
Step 2: Start capturing packets
•	In the Wireshark main window, select your active interface (usually Wi-Fi or Ethernet).
•	Click the blue shark fin icon to start capture.
Step 3: Generate DNS traffic
•	In Command Prompt, run:
nslookup www.example.com
Step 4: Stop capturing
•	Click the red square (Stop) in Wireshark.

Step 5: Filter DNS packets
•	In the filter bar at the top of Wireshark, type:
dns
•	Press Enter to filter and display only DNS-related packets.

Step 6: Analyze captured packets
•	Select the DNS query packet (from your PC to DNS server, usually UDP port 53).
•	Expand:
o	Transaction ID: used to match request & response
o	Flags: standard query, recursion desired, response
o	Questions: the domain name queried
•	Select the response packet from DNS server:
o	Observe the resolved IP address under the Answers section.

Observation Table 
Step	Command / Action	Observation
1	nslookup www.example.com
Resolved IP address shown
2	nslookup -query=MX example.com	Mail server records shown
3	Wireshark capture	DNS query and response packets
4	Packet details	Transaction ID, flags, domain name, IP address

 Result:
•	Successfully generated DNS requests using nslookup.
•	Captured and analyzed DNS packets using Wireshark on Windows.

Conclusion:
•	DNS translates domain names to IP addresses.
•	Using Wireshark on Windows helps visualize real DNS query-response exchanges.

